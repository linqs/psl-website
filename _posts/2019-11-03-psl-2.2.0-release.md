---
layout: post
title: PSL 2.2.0 Release
author: Eriq Augustine & Vihang Godbole
date: 2019-11-03 10:00:00 -0700
tags: [release, v2.2.0]
---

We are happy to announce the release of PSL version `2.2.0`!
We have made great improvements to PSL in the areas of usability and performance.

Here you will find a list of the major changes in `2.2.0` as well as information on migrating from `2.1.0`.

For those of you that learn better by example, check out the [PSL examples repository](https://github.com/linqs/psl-examples).
The `master` branch is always compatible with the most resent stable release,
while the `develop` branch stays up-to-date with our development work.

 - [Infrastructure](#infrastructure)
   - [Artifacts Moved to Maven Central](#artifacts-moved-to-maven-central)
   - [Wiki Hosted on psl.linqs.org](#wiki-hosted-on-psl.linqs.org)
   - [Development Repo Now linqs/psl](#development-repo-now-linqs/psl)
   - [Issues Moved to linqs/psl](#issues-moved-to-linqs/psl)

 - [PSL Interfaces](#psl-interfaces)
   - [New Python Interface](#new-python-interface)
   - [New Java Interface](#new-java-interface)
   - [Groovy Interface Deprecated](#groovy-interface-deprecated)

 - [CLI Improvements](#cli-improvements)
   - [Functional Predicates](#functional-predicates)
   - [Multiple Evaluators](#multiple-evaluators)
   - [Output Ground Rules](#output-ground-rules)
   - [Skip Database Commit](#skip-database-update)
   - [Simple Class Names](#simple-class-names)
   - [Remove Extra Quoting](#removed-extra-quoting)
   - [run.sh Takes Arguments](#run.sh-takes-arguments)

 - [Performance](#performance)
   - [Reduced Memory Allocations](#reduced-memory-allocations)
   - [Smaller Types](#smaller-types)
   - [Matrix Operations](#matrix-operations)
   - [Streaming Grounding Results](#streaming-grounding-results)
   - [Runtime Statistics](#runtime-statistics)

 - [Miscellanea](#miscellanea)
   - [New Weight Learning Method: GPP](#new-weight-learning-method:-gpp)
   - [Made Data Loading Errors More Clear](#made-data-loading-errors-more-clear)
   - [Removed Date ConstantType](#removed-date-constanttype)

---

## Infrastructure
The 2.2.0 release comes with a few changes to the PSL development cycle and artifact deployment.

### Artifacts Moved to Maven Central
Starting with this release, PSL releases and artifacts will now be hosted through [Maven Central](https://mvnrepository.com/repos/central).
Maven Central is the default remote repository for Maven.
With PSL deployed there, there is no longer a need to use the old Maven repository at:
`http://maven.linqs.org/maven/repositories/psl-releases/`.
Old builds will continue to be hosted at the old repository for the foreseeable future.

### Wiki Hosted on psl.linqs.org
The PSL Wiki ([https://github.com/linqs/psl/wiki])
and PSL Development Wiki ([https://github.com/eriq-augustine/psl/wiki])
have been moved to this site at [psl.linqs.org/wiki](https://psl.linqs.org/wiki/).
All stable and development releases going forward will have a version of the wiki available as either
live webpages (for newer releases) or downloadable archives (for older releases).

### API Reference Hosted on psl.linqs.org
Along with the Wiki, the API reference will now also be hosted on this site at [psl.linqs.org/api](https://psl.linqs.org/api/).
All stable and development releases going forward will have a version of the API reference available as either
live webpages (for newer releases) or downloadable archives (for older releases).

### Development Repo Now linqs/psl
PSL development has been moved from [eriq-augustine/psl](https://github.com/eriq-augustine/psl)
to the canonical PSL repository: [linqs/psl](https://github.com/linqs/psl).
Any new pull requests should be submitted there.

### Issues Moved to linqs/psl
Along with pull requests, issues have been moved to the canonical PSL repository: [linqs/psl/issues](https://github.com/linqs/psl/issues).
All old issues have been migrated to this repository.

## PSL Interfaces
The PSL 2.2.0 release comes with two new interfaces, and deprecates one.

### New Python Interface
[*a38cffe5*](https://github.com/linqs/psl/commit/a38cffe5866f070f7db9665b5fa94f4f9d957a44)

PSL 2.2.0 comes with the first official release of the PSL Python interface.
This package is called `pslpython` and is [available on PyPi](https://pypi.org/project/pslpython).
Therefore is can be installed via pip:
```
pip install pslpython
```
The source of the interface is available in the [main PSL repository](https://github.com/linqs/psl/tree/master/psl-python).

Fully implemented examples can be found in the [psl-examples repository](https://github.com/linqs/psl-examples).
Below is a simplified example of the Python interface:
```python
import os

from pslpython.model import Model
from pslpython.partition import Partition
from pslpython.predicate import Predicate
from pslpython.rule import Rule

model = Model('sample-model')

# Add Predicates
predicate = Predicate('Foo', closed = True, size = 2)
model.add_predicate(predicate)

predicate = Predicate('Bar', closed = False, size = 2)
model.add_predicate(predicate)

# Add Rules
model.add_rule(Rule('0.20: Foo(A, B) -> Bar(A, B) ^2'))
model.add_rule(Rule('0.01: !Bar(A, B) ^2'))

# Load data.
path = os.path.join('data', 'foo_obs.txt')
model.get_predicate('Foo').add_data_file(Partition.OBSERVATIONS, path)

path = os.path.join('data', 'bar_targets.txt')
model.get_predicate('Bar').add_data_file(Partition.TARGETS, path)

# Inference
results = model.infer()

# Write out results.
out_dir = 'inferred-predicates'
os.makedirs(out_dir, exist_ok = True)

out_path = os.path.join(out_dir, "bar.txt")
results[model.get_predicate('Bar')].to_csv(out_path, sep = "\t", header = False, index = False)
```

In addition to creating models in Python, you can use the PSL python package to invoke the PSL CLI interface directory.
Instead of invoking the PSL jar:
```sh
java -jar psl.jar --model test.psl --data test.data
```
You can use the `pslpython` package already installed via pip:
```sh
python -m pslpython.cli --model test.psl --data test.data
```

### New Java Interface
[*7e305dfe*](https://github.com/linqs/psl/commit/7e305dfea1a0e092b43ece80f4e44f71777ee330)
Pure Java interface  

### Groovy Interface Deprecated
[*476dfd1e*](https://github.com/linqs/psl/commit/476dfd1e745919dc5a2cef4ac521806eb252cac1)
Deprecate Groovy in favor of Java.


## CLI Improvements

### Functional Predicates
[*ac2f9a30*](https://github.com/linqs/psl/commit/ac2f9a30d42951a4c0c9a90ade1edfdce0e2fe5d)
[Functional predicates](https://psl.linqs.org/wiki/master/External-Functions.html) are now supported in the CLI.
To use these, a function key needs to be specified in the predicate definition, e.g:
```yaml:
  Knows/2: open
  Likes/2: closed
  Lived/2: closed
  SimName:
    - function: org.foo.bar.SimNameExternalFunction
```

In this case, the functional predicate is `SimName` and it is specified by the `SimNameExternalFunction`.
This can then be used in a rule like:
`1: SimName(P1, P2) & Lived(P1, L) & Lived(P2, L) & (P1 != P2) -> Knows(P1, P2) ^2`.

### Multiple Evaluators
[*d63a8f7e*](https://github.com/linqs/psl/commit/d63a8f7ee1c9bfb881bb53770e3e84db34c2668b)
Added ability to specify multiple evaluators in CLI. This can be done by passing in multiple evaluators separated by spaces. eg: `./run.sh --eval CategoricalEvaluator ContinuousEvaluator`.

### Output Ground Rules
[*62fbd2cc*](https://github.com/linqs/psl/commit/62fbd2cc20c8360c365a02be2cdc4f871a4f5798)
[*b901e937*](https://github.com/linqs/psl/commit/b901e937ed2869b5dcc184585ea29c5fa77b1170)
Added a new option to CLI (-gr/--groundrules) that will output the ground rules to the specified file (stdout if no path specified). e.g: `./run.sh --groundrules ground.txt`.
Added the ability to output ground rules along with their satisfaction either to the specified file or stdout (Use --satisfaction flag). e.g: `./run.sh --satisfaction satisfaction.txt`.

### Skip Database Commit
[*3ced4b20*](https://github.com/linqs/psl/commit/3ced4b20be80fc17403663fe16e194bcfcaf6a3a)
Added option to skip committing atoms to database after inference (--skipCommitAtoms):
Atoms get committed to the database after inference by default. We now provide an option to skip the commits which means that the inferred atoms will no longer be persisted in the database. 

### Simple Class Names
[*00b60321*](https://github.com/linqs/psl/commit/00b603211d070729bc486c558846c3cfebcc4bb7)
Allow simple names for classes 

### Remove Extra Quoting
[*cbe7fd8a*](https://github.com/linqs/psl/commit/cbe7fd8a3c8e5dc9a296836f5574e98353328323)
Removed extra quoting from CLI output. 

### run.sh Takes Arguments
run.sh in CLI psl-examples now takes blind arguments.

## Performance

### Reduced Memory Allocations
Alocations

### Smaller Types
[*9a34ce23*](https://github.com/linqs/psl/commit/9a34ce235b65cd549c28b9b64cbc94a496d1350c)
Shorter types (short/float) 

### Matrix Operations
[*8f034fa8*](https://github.com/linqs/psl/commit/8f034fa8315d3f6461cd38435612d889c745f4a2)
Added a class to handle low level matrix operations. 

### Streaming Grounding Results
[*8f4de846*](https://github.com/linqs/psl/commit/8f4de8464b79ace097ad577dff0bcbfa63369b3e)
Streaming grounding results from the database to grounding. 

### Runtime Statistics
[*df58a390*](https://github.com/linqs/psl/commit/df58a390181a1f32ef536674e56e92d20d2257e0)
Added RuntimeStats 


## Miscellanea

### New Weight Learning Method: GPP
Added GPP weight learning algorithm to PSL

### Made Data Loading Errors More Clear
[*1e889f49*](https://github.com/linqs/psl/commit/1e889f49d23ebc438e581fec8a092e50526d9550)
Data loading errors 

### Removed Date ConstantType
[*df5e1b64*](https://github.com/linqs/psl/commit/df5e1b641d5274dd590bc2a917259a9e38bed464)
Removed Date ConstantType 
